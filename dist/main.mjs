import te from"os";import le from"fs";import fe from"path";import de from"http";import he from"https";import"net";import Me from"tls";import je from"events";import"assert";import De from"util";var y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oe={},K={},I={};Object.defineProperty(I,"__esModule",{value:!0}),I.toCommandProperties=I.toCommandValue=void 0;function Be(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}I.toCommandValue=Be;function ke(e){return Object.keys(e).length?{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}}I.toCommandProperties=ke;var Ne=y&&y.__createBinding||(Object.create?function(e,t,a,u){u===void 0&&(u=a),Object.defineProperty(e,u,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,u){u===void 0&&(u=a),e[u]=t[a]}),Le=y&&y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ie=y&&y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var a in e)a!=="default"&&Object.hasOwnProperty.call(e,a)&&Ne(t,e,a);return Le(t,e),t};Object.defineProperty(K,"__esModule",{value:!0}),K.issue=K.issueCommand=void 0;const Fe=Ie(te),pe=I;function me(e,t,a){const u=new Ve(e,t,a);process.stdout.write(u.toString()+Fe.EOL)}K.issueCommand=me;function Ge(e,t=""){me(e,{},t)}K.issue=Ge;const ve="::";class Ve{constructor(t,a,u){t||(t="missing.command"),this.command=t,this.properties=a,this.message=u}toString(){let t=ve+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let a=!0;for(const u in this.properties)if(this.properties.hasOwnProperty(u)){const d=this.properties[u];d&&(a?a=!1:t+=",",t+=`${u}=${Je(d)}`)}}return t+=`${ve}${xe(this.message)}`,t}}function xe(e){return pe.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function Je(e){return pe.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}var ne={},He=y&&y.__createBinding||(Object.create?function(e,t,a,u){u===void 0&&(u=a),Object.defineProperty(e,u,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,u){u===void 0&&(u=a),e[u]=t[a]}),ze=y&&y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ge=y&&y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var a in e)a!=="default"&&Object.hasOwnProperty.call(e,a)&&He(t,e,a);return ze(t,e),t};Object.defineProperty(ne,"__esModule",{value:!0}),ne.issueCommand=void 0;const _e=ge(le),Ke=ge(te),Ye=I;function We(e,t){const a=process.env[`GITHUB_${e}`];if(!a)throw new Error(`Unable to find environment variable for file command ${e}`);if(!_e.existsSync(a))throw new Error(`Missing file at path: ${a}`);_e.appendFileSync(a,`${Ye.toCommandValue(t)}${Ke.EOL}`,{encoding:"utf8"})}ne.issueCommand=We;var X={},ye={},Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.checkBypass=Y.getProxyUrl=void 0;function Qe(e){const t=e.protocol==="https:";if(we(e))return;const a=(()=>t?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY)();if(a)return new URL(a)}Y.getProxyUrl=Qe;function we(e){if(!e.hostname)return!1;const t=process.env.no_proxy||process.env.NO_PROXY||"";if(!t)return!1;let a;e.port?a=Number(e.port):e.protocol==="http:"?a=80:e.protocol==="https:"&&(a=443);const u=[e.hostname.toUpperCase()];typeof a=="number"&&u.push(`${u[0]}:${a}`);for(const d of t.split(",").map(h=>h.trim().toUpperCase()).filter(h=>h))if(u.some(h=>h===d))return!0;return!1}Y.checkBypass=we;var Oe={exports:{}},W={},Xe=Me,se=de,be=he,Ze=je,et=De;W.httpOverHttp=tt,W.httpsOverHttp=nt,W.httpOverHttps=rt,W.httpsOverHttps=it;function tt(e){var t=new N(e);return t.request=se.request,t}function nt(e){var t=new N(e);return t.request=se.request,t.createSocket=Re,t.defaultPort=443,t}function rt(e){var t=new N(e);return t.request=be.request,t}function it(e){var t=new N(e);return t.request=be.request,t.createSocket=Re,t.defaultPort=443,t}function N(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||se.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",function(u,d,h,m){for(var l=Ee(d,h,m),v=0,g=t.requests.length;v<g;++v){var s=t.requests[v];if(s.host===l.host&&s.port===l.port){t.requests.splice(v,1),s.request.onSocket(u);return}}u.destroy(),t.removeSocket(u)})}et.inherits(N,Ze.EventEmitter),N.prototype.addRequest=function(t,a,u,d){var h=this,m=ae({request:t},h.options,Ee(a,u,d));if(h.sockets.length>=this.maxSockets){h.requests.push(m);return}h.createSocket(m,function(l){l.on("free",v),l.on("close",g),l.on("agentRemove",g),t.onSocket(l);function v(){h.emit("free",l,m)}function g(s){h.removeSocket(l),l.removeListener("free",v),l.removeListener("close",g),l.removeListener("agentRemove",g)}})},N.prototype.createSocket=function(t,a){var u=this,d={};u.sockets.push(d);var h=ae({},u.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(h.localAddress=t.localAddress),h.proxyAuth&&(h.headers=h.headers||{},h.headers["Proxy-Authorization"]="Basic "+new Buffer(h.proxyAuth).toString("base64")),F("making CONNECT request");var m=u.request(h);m.useChunkedEncodingByDefault=!1,m.once("response",l),m.once("upgrade",v),m.once("connect",g),m.once("error",s),m.end();function l(f){f.upgrade=!0}function v(f,_,S){process.nextTick(function(){g(f,_,S)})}function g(f,_,S){if(m.removeAllListeners(),_.removeAllListeners(),f.statusCode!==200){F("tunneling socket could not be established, statusCode=%d",f.statusCode),_.destroy();var E=new Error("tunneling socket could not be established, statusCode="+f.statusCode);E.code="ECONNRESET",t.request.emit("error",E),u.removeSocket(d);return}if(S.length>0){F("got illegal response body from proxy"),_.destroy();var E=new Error("got illegal response body from proxy");E.code="ECONNRESET",t.request.emit("error",E),u.removeSocket(d);return}return F("tunneling connection has established"),u.sockets[u.sockets.indexOf(d)]=_,a(_)}function s(f){m.removeAllListeners(),F(`tunneling socket could not be established, cause=%s
`,f.message,f.stack);var _=new Error("tunneling socket could not be established, cause="+f.message);_.code="ECONNRESET",t.request.emit("error",_),u.removeSocket(d)}},N.prototype.removeSocket=function(t){var a=this.sockets.indexOf(t);if(a!==-1){this.sockets.splice(a,1);var u=this.requests.shift();u&&this.createSocket(u,function(d){u.request.onSocket(d)})}};function Re(e,t){var a=this;N.prototype.createSocket.call(a,e,function(u){var d=e.request.getHeader("host"),h=ae({},a.options,{socket:u,servername:d?d.replace(/:.*$/,""):e.host}),m=Xe.connect(0,h);a.sockets[a.sockets.indexOf(u)]=m,t(m)})}function Ee(e,t,a){return typeof e=="string"?{host:e,port:t,localAddress:a}:e}function ae(e){for(var t=1,a=arguments.length;t<a;++t){var u=arguments[t];if(typeof u=="object")for(var d=Object.keys(u),h=0,m=d.length;h<m;++h){var l=d[h];u[l]!==void 0&&(e[l]=u[l])}}return e}var F;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?F=function(){var e=Array.prototype.slice.call(arguments);typeof e[0]=="string"?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:F=function(){},W.debug=F,function(e){e.exports=W}(Oe),function(e){var t=y&&y.__createBinding||(Object.create?function(i,o,n,r){r===void 0&&(r=n),Object.defineProperty(i,r,{enumerable:!0,get:function(){return o[n]}})}:function(i,o,n,r){r===void 0&&(r=n),i[r]=o[n]}),a=y&&y.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),u=y&&y.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var n in i)n!=="default"&&Object.hasOwnProperty.call(i,n)&&t(o,i,n);return a(o,i),o},d=y&&y.__awaiter||function(i,o,n,r){function p(w){return w instanceof n?w:new n(function(R){R(w)})}return new(n||(n=Promise))(function(w,R){function C(U){try{O(r.next(U))}catch(q){R(q)}}function A(U){try{O(r.throw(U))}catch(q){R(q)}}function O(U){U.done?w(U.value):p(U.value).then(C,A)}O((r=r.apply(i,o||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.HttpClient=e.isHttps=e.HttpClientResponse=e.HttpClientError=e.getProxyUrl=e.MediaTypes=e.Headers=e.HttpCodes=void 0;const h=u(de),m=u(he),l=u(Y),v=u(Oe.exports);var g;(function(i){i[i.OK=200]="OK",i[i.MultipleChoices=300]="MultipleChoices",i[i.MovedPermanently=301]="MovedPermanently",i[i.ResourceMoved=302]="ResourceMoved",i[i.SeeOther=303]="SeeOther",i[i.NotModified=304]="NotModified",i[i.UseProxy=305]="UseProxy",i[i.SwitchProxy=306]="SwitchProxy",i[i.TemporaryRedirect=307]="TemporaryRedirect",i[i.PermanentRedirect=308]="PermanentRedirect",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.PaymentRequired=402]="PaymentRequired",i[i.Forbidden=403]="Forbidden",i[i.NotFound=404]="NotFound",i[i.MethodNotAllowed=405]="MethodNotAllowed",i[i.NotAcceptable=406]="NotAcceptable",i[i.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",i[i.RequestTimeout=408]="RequestTimeout",i[i.Conflict=409]="Conflict",i[i.Gone=410]="Gone",i[i.TooManyRequests=429]="TooManyRequests",i[i.InternalServerError=500]="InternalServerError",i[i.NotImplemented=501]="NotImplemented",i[i.BadGateway=502]="BadGateway",i[i.ServiceUnavailable=503]="ServiceUnavailable",i[i.GatewayTimeout=504]="GatewayTimeout"})(g=e.HttpCodes||(e.HttpCodes={}));var s;(function(i){i.Accept="accept",i.ContentType="content-type"})(s=e.Headers||(e.Headers={}));var f;(function(i){i.ApplicationJson="application/json"})(f=e.MediaTypes||(e.MediaTypes={}));function _(i){const o=l.getProxyUrl(new URL(i));return o?o.href:""}e.getProxyUrl=_;const S=[g.MovedPermanently,g.ResourceMoved,g.SeeOther,g.TemporaryRedirect,g.PermanentRedirect],E=[g.BadGateway,g.ServiceUnavailable,g.GatewayTimeout],P=["OPTIONS","GET","DELETE","HEAD"],j=10,V=5;class D extends Error{constructor(o,n){super(o),this.name="HttpClientError",this.statusCode=n,Object.setPrototypeOf(this,D.prototype)}}e.HttpClientError=D;class M{constructor(o){this.message=o}readBody(){return d(this,void 0,void 0,function*(){return new Promise(o=>d(this,void 0,void 0,function*(){let n=Buffer.alloc(0);this.message.on("data",r=>{n=Buffer.concat([n,r])}),this.message.on("end",()=>{o(n.toString())})}))})}}e.HttpClientResponse=M;function k(i){return new URL(i).protocol==="https:"}e.isHttps=k;class Q{constructor(o,n,r){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=o,this.handlers=n||[],this.requestOptions=r,r&&(r.ignoreSslError!=null&&(this._ignoreSslError=r.ignoreSslError),this._socketTimeout=r.socketTimeout,r.allowRedirects!=null&&(this._allowRedirects=r.allowRedirects),r.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=r.allowRedirectDowngrade),r.maxRedirects!=null&&(this._maxRedirects=Math.max(r.maxRedirects,0)),r.keepAlive!=null&&(this._keepAlive=r.keepAlive),r.allowRetries!=null&&(this._allowRetries=r.allowRetries),r.maxRetries!=null&&(this._maxRetries=r.maxRetries))}options(o,n){return d(this,void 0,void 0,function*(){return this.request("OPTIONS",o,null,n||{})})}get(o,n){return d(this,void 0,void 0,function*(){return this.request("GET",o,null,n||{})})}del(o,n){return d(this,void 0,void 0,function*(){return this.request("DELETE",o,null,n||{})})}post(o,n,r){return d(this,void 0,void 0,function*(){return this.request("POST",o,n,r||{})})}patch(o,n,r){return d(this,void 0,void 0,function*(){return this.request("PATCH",o,n,r||{})})}put(o,n,r){return d(this,void 0,void 0,function*(){return this.request("PUT",o,n,r||{})})}head(o,n){return d(this,void 0,void 0,function*(){return this.request("HEAD",o,null,n||{})})}sendStream(o,n,r,p){return d(this,void 0,void 0,function*(){return this.request(o,n,r,p)})}getJson(o,n={}){return d(this,void 0,void 0,function*(){n[s.Accept]=this._getExistingOrDefaultHeader(n,s.Accept,f.ApplicationJson);const r=yield this.get(o,n);return this._processResponse(r,this.requestOptions)})}postJson(o,n,r={}){return d(this,void 0,void 0,function*(){const p=JSON.stringify(n,null,2);r[s.Accept]=this._getExistingOrDefaultHeader(r,s.Accept,f.ApplicationJson),r[s.ContentType]=this._getExistingOrDefaultHeader(r,s.ContentType,f.ApplicationJson);const w=yield this.post(o,p,r);return this._processResponse(w,this.requestOptions)})}putJson(o,n,r={}){return d(this,void 0,void 0,function*(){const p=JSON.stringify(n,null,2);r[s.Accept]=this._getExistingOrDefaultHeader(r,s.Accept,f.ApplicationJson),r[s.ContentType]=this._getExistingOrDefaultHeader(r,s.ContentType,f.ApplicationJson);const w=yield this.put(o,p,r);return this._processResponse(w,this.requestOptions)})}patchJson(o,n,r={}){return d(this,void 0,void 0,function*(){const p=JSON.stringify(n,null,2);r[s.Accept]=this._getExistingOrDefaultHeader(r,s.Accept,f.ApplicationJson),r[s.ContentType]=this._getExistingOrDefaultHeader(r,s.ContentType,f.ApplicationJson);const w=yield this.patch(o,p,r);return this._processResponse(w,this.requestOptions)})}request(o,n,r,p){return d(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");const w=new URL(n);let R=this._prepareRequest(o,w,p);const C=this._allowRetries&&P.includes(o)?this._maxRetries+1:1;let A=0,O;do{if(O=yield this.requestRaw(R,r),O&&O.message&&O.message.statusCode===g.Unauthorized){let q;for(const B of this.handlers)if(B.canHandleAuthentication(O)){q=B;break}return q?q.handleAuthentication(this,R,r):O}let U=this._maxRedirects;for(;O.message.statusCode&&S.includes(O.message.statusCode)&&this._allowRedirects&&U>0;){const q=O.message.headers.location;if(!q)break;const B=new URL(q);if(w.protocol==="https:"&&w.protocol!==B.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield O.readBody(),B.hostname!==w.hostname)for(const c in p)c.toLowerCase()==="authorization"&&delete p[c];R=this._prepareRequest(o,B,p),O=yield this.requestRaw(R,r),U--}if(!O.message.statusCode||!E.includes(O.message.statusCode))return O;A+=1,A<C&&(yield O.readBody(),yield this._performExponentialBackoff(A))}while(A<C);return O})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(o,n){return d(this,void 0,void 0,function*(){return new Promise((r,p)=>{function w(R,C){R?p(R):C?r(C):p(new Error("Unknown error"))}this.requestRawWithCallback(o,n,w)})})}requestRawWithCallback(o,n,r){typeof n=="string"&&(o.options.headers||(o.options.headers={}),o.options.headers["Content-Length"]=Buffer.byteLength(n,"utf8"));let p=!1;function w(A,O){p||(p=!0,r(A,O))}const R=o.httpModule.request(o.options,A=>{const O=new M(A);w(void 0,O)});let C;R.on("socket",A=>{C=A}),R.setTimeout(this._socketTimeout||3*6e4,()=>{C&&C.end(),w(new Error(`Request timeout: ${o.options.path}`))}),R.on("error",function(A){w(A)}),n&&typeof n=="string"&&R.write(n,"utf8"),n&&typeof n!="string"?(n.on("close",function(){R.end()}),n.pipe(R)):R.end()}getAgent(o){const n=new URL(o);return this._getAgent(n)}_prepareRequest(o,n,r){const p={};p.parsedUrl=n;const w=p.parsedUrl.protocol==="https:";p.httpModule=w?m:h;const R=w?443:80;if(p.options={},p.options.host=p.parsedUrl.hostname,p.options.port=p.parsedUrl.port?parseInt(p.parsedUrl.port):R,p.options.path=(p.parsedUrl.pathname||"")+(p.parsedUrl.search||""),p.options.method=o,p.options.headers=this._mergeHeaders(r),this.userAgent!=null&&(p.options.headers["user-agent"]=this.userAgent),p.options.agent=this._getAgent(p.parsedUrl),this.handlers)for(const C of this.handlers)C.prepareRequest(p.options);return p}_mergeHeaders(o){return this.requestOptions&&this.requestOptions.headers?Object.assign({},z(this.requestOptions.headers),z(o||{})):z(o||{})}_getExistingOrDefaultHeader(o,n,r){let p;return this.requestOptions&&this.requestOptions.headers&&(p=z(this.requestOptions.headers)[n]),o[n]||p||r}_getAgent(o){let n;const r=l.getProxyUrl(o),p=r&&r.hostname;if(this._keepAlive&&p&&(n=this._proxyAgent),this._keepAlive&&!p&&(n=this._agent),n)return n;const w=o.protocol==="https:";let R=100;if(this.requestOptions&&(R=this.requestOptions.maxSockets||h.globalAgent.maxSockets),r&&r.hostname){const C={maxSockets:R,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(r.username||r.password)&&{proxyAuth:`${r.username}:${r.password}`}),{host:r.hostname,port:r.port})};let A;const O=r.protocol==="https:";w?A=O?v.httpsOverHttps:v.httpsOverHttp:A=O?v.httpOverHttps:v.httpOverHttp,n=A(C),this._proxyAgent=n}if(this._keepAlive&&!n){const C={keepAlive:this._keepAlive,maxSockets:R};n=w?new m.Agent(C):new h.Agent(C),this._agent=n}return n||(n=w?m.globalAgent:h.globalAgent),w&&this._ignoreSslError&&(n.options=Object.assign(n.options||{},{rejectUnauthorized:!1})),n}_performExponentialBackoff(o){return d(this,void 0,void 0,function*(){o=Math.min(j,o);const n=V*Math.pow(2,o);return new Promise(r=>setTimeout(()=>r(),n))})}_processResponse(o,n){return d(this,void 0,void 0,function*(){return new Promise((r,p)=>d(this,void 0,void 0,function*(){const w=o.message.statusCode||0,R={statusCode:w,result:null,headers:{}};w===g.NotFound&&r(R);function C(U,q){if(typeof q=="string"){const B=new Date(q);if(!isNaN(B.valueOf()))return B}return q}let A,O;try{O=yield o.readBody(),O&&O.length>0&&(n&&n.deserializeDates?A=JSON.parse(O,C):A=JSON.parse(O),R.result=A),R.headers=o.message.headers}catch{}if(w>299){let U;A&&A.message?U=A.message:O&&O.length>0?U=O:U=`Failed request: (${w})`;const q=new D(U,w);q.result=R.result,p(q)}else r(R)}))})}}e.HttpClient=Q;const z=i=>Object.keys(i).reduce((o,n)=>(o[n.toLowerCase()]=i[n],o),{})}(ye);var G={},ue=y&&y.__awaiter||function(e,t,a,u){function d(h){return h instanceof a?h:new a(function(m){m(h)})}return new(a||(a=Promise))(function(h,m){function l(s){try{g(u.next(s))}catch(f){m(f)}}function v(s){try{g(u.throw(s))}catch(f){m(f)}}function g(s){s.done?h(s.value):d(s.value).then(l,v)}g((u=u.apply(e,t||[])).next())})};Object.defineProperty(G,"__esModule",{value:!0}),G.PersonalAccessTokenCredentialHandler=G.BearerCredentialHandler=G.BasicCredentialHandler=void 0;class ot{constructor(t,a){this.username=t,this.password=a}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return ue(this,void 0,void 0,function*(){throw new Error("not implemented")})}}G.BasicCredentialHandler=ot;class st{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return ue(this,void 0,void 0,function*(){throw new Error("not implemented")})}}G.BearerCredentialHandler=st;class at{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return ue(this,void 0,void 0,function*(){throw new Error("not implemented")})}}G.PersonalAccessTokenCredentialHandler=at;var Se;function ut(){if(Se)return X;Se=1;var e=y&&y.__awaiter||function(h,m,l,v){function g(s){return s instanceof l?s:new l(function(f){f(s)})}return new(l||(l=Promise))(function(s,f){function _(P){try{E(v.next(P))}catch(j){f(j)}}function S(P){try{E(v.throw(P))}catch(j){f(j)}}function E(P){P.done?s(P.value):g(P.value).then(_,S)}E((v=v.apply(h,m||[])).next())})};Object.defineProperty(X,"__esModule",{value:!0}),X.OidcClient=void 0;const t=ye,a=G,u=Ue();class d{static createHttpClient(m=!0,l=10){const v={allowRetries:m,maxRetries:l};return new t.HttpClient("actions/oidc-client",[new a.BearerCredentialHandler(d.getRequestToken())],v)}static getRequestToken(){const m=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!m)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return m}static getIDTokenUrl(){const m=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!m)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return m}static getCall(m){var l;return e(this,void 0,void 0,function*(){const s=(l=(yield d.createHttpClient().getJson(m).catch(f=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${f.statusCode}
 
        Error Message: ${f.result.message}`)})).result)===null||l===void 0?void 0:l.value;if(!s)throw new Error("Response json body do not have ID Token field");return s})}static getIDToken(m){return e(this,void 0,void 0,function*(){try{let l=d.getIDTokenUrl();if(m){const g=encodeURIComponent(m);l=`${l}&audience=${g}`}u.debug(`ID token url is ${l}`);const v=yield d.getCall(l);return u.setSecret(v),v}catch(l){throw new Error(`Error message: ${l.message}`)}})}}return X.OidcClient=d,X}var ce={},Pe;function Te(){return Pe||(Pe=1,function(e){var t=y&&y.__awaiter||function(g,s,f,_){function S(E){return E instanceof f?E:new f(function(P){P(E)})}return new(f||(f=Promise))(function(E,P){function j(M){try{D(_.next(M))}catch(k){P(k)}}function V(M){try{D(_.throw(M))}catch(k){P(k)}}function D(M){M.done?E(M.value):S(M.value).then(j,V)}D((_=_.apply(g,s||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.summary=e.markdownSummary=e.SUMMARY_DOCS_URL=e.SUMMARY_ENV_VAR=void 0;const a=te,u=le,{access:d,appendFile:h,writeFile:m}=u.promises;e.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY",e.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";class l{constructor(){this._buffer=""}filePath(){return t(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;const s=process.env[e.SUMMARY_ENV_VAR];if(!s)throw new Error(`Unable to find environment variable for $${e.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield d(s,u.constants.R_OK|u.constants.W_OK)}catch{throw new Error(`Unable to access summary file: '${s}'. Check if the file has correct read/write permissions.`)}return this._filePath=s,this._filePath})}wrap(s,f,_={}){const S=Object.entries(_).map(([E,P])=>` ${E}="${P}"`).join("");return f?`<${s}${S}>${f}</${s}>`:`<${s}${S}>`}write(s){return t(this,void 0,void 0,function*(){const f=!!s?.overwrite,_=yield this.filePath();return yield(f?m:h)(_,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return t(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(s,f=!1){return this._buffer+=s,f?this.addEOL():this}addEOL(){return this.addRaw(a.EOL)}addCodeBlock(s,f){const _=Object.assign({},f&&{lang:f}),S=this.wrap("pre",this.wrap("code",s),_);return this.addRaw(S).addEOL()}addList(s,f=!1){const _=f?"ol":"ul",S=s.map(P=>this.wrap("li",P)).join(""),E=this.wrap(_,S);return this.addRaw(E).addEOL()}addTable(s){const f=s.map(S=>{const E=S.map(P=>{if(typeof P=="string")return this.wrap("td",P);const{header:j,data:V,colspan:D,rowspan:M}=P,k=j?"th":"td",Q=Object.assign(Object.assign({},D&&{colspan:D}),M&&{rowspan:M});return this.wrap(k,V,Q)}).join("");return this.wrap("tr",E)}).join(""),_=this.wrap("table",f);return this.addRaw(_).addEOL()}addDetails(s,f){const _=this.wrap("details",this.wrap("summary",s)+f);return this.addRaw(_).addEOL()}addImage(s,f,_){const{width:S,height:E}=_||{},P=Object.assign(Object.assign({},S&&{width:S}),E&&{height:E}),j=this.wrap("img",null,Object.assign({src:s,alt:f},P));return this.addRaw(j).addEOL()}addHeading(s,f){const _=`h${f}`,S=["h1","h2","h3","h4","h5","h6"].includes(_)?_:"h1",E=this.wrap(S,s);return this.addRaw(E).addEOL()}addSeparator(){const s=this.wrap("hr",null);return this.addRaw(s).addEOL()}addBreak(){const s=this.wrap("br",null);return this.addRaw(s).addEOL()}addQuote(s,f){const _=Object.assign({},f&&{cite:f}),S=this.wrap("blockquote",s,_);return this.addRaw(S).addEOL()}addLink(s,f){const _=this.wrap("a",s,{href:f});return this.addRaw(_).addEOL()}}const v=new l;e.markdownSummary=v,e.summary=v}(ce)),ce}var L={},Ae;function ct(){if(Ae)return L;Ae=1;var e=y&&y.__createBinding||(Object.create?function(l,v,g,s){s===void 0&&(s=g),Object.defineProperty(l,s,{enumerable:!0,get:function(){return v[g]}})}:function(l,v,g,s){s===void 0&&(s=g),l[s]=v[g]}),t=y&&y.__setModuleDefault||(Object.create?function(l,v){Object.defineProperty(l,"default",{enumerable:!0,value:v})}:function(l,v){l.default=v}),a=y&&y.__importStar||function(l){if(l&&l.__esModule)return l;var v={};if(l!=null)for(var g in l)g!=="default"&&Object.hasOwnProperty.call(l,g)&&e(v,l,g);return t(v,l),v};Object.defineProperty(L,"__esModule",{value:!0}),L.toPlatformPath=L.toWin32Path=L.toPosixPath=void 0;const u=a(fe);function d(l){return l.replace(/[\\]/g,"/")}L.toPosixPath=d;function h(l){return l.replace(/[/]/g,"\\")}L.toWin32Path=h;function m(l){return l.replace(/[/\\]/g,u.sep)}return L.toPlatformPath=m,L}var Ce;function Ue(){return Ce||(Ce=1,function(e){var t=y&&y.__createBinding||(Object.create?function(c,b,T,$){$===void 0&&($=T),Object.defineProperty(c,$,{enumerable:!0,get:function(){return b[T]}})}:function(c,b,T,$){$===void 0&&($=T),c[$]=b[T]}),a=y&&y.__setModuleDefault||(Object.create?function(c,b){Object.defineProperty(c,"default",{enumerable:!0,value:b})}:function(c,b){c.default=b}),u=y&&y.__importStar||function(c){if(c&&c.__esModule)return c;var b={};if(c!=null)for(var T in c)T!=="default"&&Object.hasOwnProperty.call(c,T)&&t(b,c,T);return a(b,c),b},d=y&&y.__awaiter||function(c,b,T,$){function x(J){return J instanceof T?J:new T(function(ee){ee(J)})}return new(T||(T=Promise))(function(J,ee){function qe(H){try{re($.next(H))}catch(ie){ee(ie)}}function $e(H){try{re($.throw(H))}catch(ie){ee(ie)}}function re(H){H.done?J(H.value):x(H.value).then(qe,$e)}re(($=$.apply(c,b||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.getIDToken=e.getState=e.saveState=e.group=e.endGroup=e.startGroup=e.info=e.notice=e.warning=e.error=e.debug=e.isDebug=e.setFailed=e.setCommandEcho=e.setOutput=e.getBooleanInput=e.getMultilineInput=e.getInput=e.addPath=e.setSecret=e.exportVariable=e.ExitCode=void 0;const h=K,m=ne,l=I,v=u(te),g=u(fe),s=ut();var f;(function(c){c[c.Success=0]="Success",c[c.Failure=1]="Failure"})(f=e.ExitCode||(e.ExitCode={}));function _(c,b){const T=l.toCommandValue(b);if(process.env[c]=T,process.env.GITHUB_ENV||""){const x="_GitHubActionsFileCommandDelimeter_",J=`${c}<<${x}${v.EOL}${T}${v.EOL}${x}`;m.issueCommand("ENV",J)}else h.issueCommand("set-env",{name:c},T)}e.exportVariable=_;function S(c){h.issueCommand("add-mask",{},c)}e.setSecret=S;function E(c){process.env.GITHUB_PATH||""?m.issueCommand("PATH",c):h.issueCommand("add-path",{},c),process.env.PATH=`${c}${g.delimiter}${process.env.PATH}`}e.addPath=E;function P(c,b){const T=process.env[`INPUT_${c.replace(/ /g,"_").toUpperCase()}`]||"";if(b&&b.required&&!T)throw new Error(`Input required and not supplied: ${c}`);return b&&b.trimWhitespace===!1?T:T.trim()}e.getInput=P;function j(c,b){return P(c,b).split(`
`).filter($=>$!=="")}e.getMultilineInput=j;function V(c,b){const T=["true","True","TRUE"],$=["false","False","FALSE"],x=P(c,b);if(T.includes(x))return!0;if($.includes(x))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${c}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}e.getBooleanInput=V;function D(c,b){process.stdout.write(v.EOL),h.issueCommand("set-output",{name:c},b)}e.setOutput=D;function M(c){h.issue("echo",c?"on":"off")}e.setCommandEcho=M;function k(c){process.exitCode=f.Failure,i(c)}e.setFailed=k;function Q(){return process.env.RUNNER_DEBUG==="1"}e.isDebug=Q;function z(c){h.issueCommand("debug",{},c)}e.debug=z;function i(c,b={}){h.issueCommand("error",l.toCommandProperties(b),c instanceof Error?c.toString():c)}e.error=i;function o(c,b={}){h.issueCommand("warning",l.toCommandProperties(b),c instanceof Error?c.toString():c)}e.warning=o;function n(c,b={}){h.issueCommand("notice",l.toCommandProperties(b),c instanceof Error?c.toString():c)}e.notice=n;function r(c){process.stdout.write(c+v.EOL)}e.info=r;function p(c){h.issue("group",c)}e.startGroup=p;function w(){h.issue("endgroup")}e.endGroup=w;function R(c,b){return d(this,void 0,void 0,function*(){p(c);let T;try{T=yield b()}finally{w()}return T})}e.group=R;function C(c,b){h.issueCommand("save-state",{name:c},b)}e.saveState=C;function A(c){return process.env[`STATE_${c}`]||""}e.getState=A;function O(c){return d(this,void 0,void 0,function*(){return yield s.OidcClient.getIDToken(c)})}e.getIDToken=O;var U=Te();Object.defineProperty(e,"summary",{enumerable:!0,get:function(){return U.summary}});var q=Te();Object.defineProperty(e,"markdownSummary",{enumerable:!0,get:function(){return q.markdownSummary}});var B=ct();Object.defineProperty(e,"toPosixPath",{enumerable:!0,get:function(){return B.toPosixPath}}),Object.defineProperty(e,"toWin32Path",{enumerable:!0,get:function(){return B.toWin32Path}}),Object.defineProperty(e,"toPlatformPath",{enumerable:!0,get:function(){return B.toPlatformPath}})}(oe)),oe}var Z=Ue();const lt=({delimiter:e,target:t}={})=>t===void 0||!t.trim()?"":(e!==void 0&&(t=t.split(e).pop()),t?/([a-z]+)/.exec(t)?.[0].trim()??"":"");function ft(){try{const e=Z.getInput("delimiter")||void 0,t=Z.getInput("target"),a=lt({delimiter:e,target:t});Z.setOutput("flag",a&&["--tag",a].join(" ").trim()),Z.setOutput("tag",a)}catch(e){Z.setFailed(e)}}ft();
